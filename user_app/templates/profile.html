{% extends 'base.html' %}

{% block title %} User page {% endblock %}

{% block head %} 
<script defer src="{{ url_for('create.static', filename='js/jquery.js') }}"></script>

<link rel="stylesheet" href="{{ url_for('profile.static', filename='css/profile.css') }}">
<script defer src="{{ url_for('profile.static', filename = 'js/profile.js') }}"></script>
{% endblock %}

{% block content %} 

{% if user_id == current_id %}
    {% set is_author = True %}
{% else %}
    {% set is_author = False %}
{% endif %}
<input type="hidden" id="is_author" value="{{ 2 if is_author else 4 }}">

    <div class="container">
        <div class="user-block">
            <div class="user-chartics">
                {% if image %}
                    <img src="{{ url_for('profile.static', filename='images/' + user.nickname + '.png') }}">
                {% else %}
                    <img class="circle" src="{{ url_for('profile.static', filename='images/profile.png') }}">
                {% endif %}
                {% if not is_author %}
                    <div class="block-user">
                        <p class="user-nickname">{{ user.nickname }}</p>
                        <div class="user-count">Створених тестів: {{ count_created_tests }}</div>
                        <div class="user-count">Пройдених тести: {{ count_completed_tests }}</div>
                    </div>
                {% endif %}
            </div>
                <textarea name="description" class="add-description" placeholder="Введіть опис...">{{ user.description }}</textarea>
        </div>

        <div class="tests-block">
            <div class="wrapper">
                <div class="option">
                    <input class="input" type="radio" name="btn" value="option1" checked="">
                    <div class="btn">
                        <span class="span">Створенні</span>
                    </div>
                </div>
                <div class="option">
                    <input class="input" type="radio" name="btn" value="option2">
                    <div class="btn">
                        <span class="span">Пройдені</span>
                    </div>
                </div>
            </div>
            <div class="created-tests" id="created-tests">
                {% if list_created_tests %}
                {% for tid in list_created_tests %}
                {% set test = Test.query.get(tid) %}
                {% if test %}
                
                <div class="test" data-id="{{ test.id }}" data-title="{{ test.name }}" data-description="{{ test.description or '' }}">
                                <div class="name-block">
                                    <span class="name">{{ test.name }}</span>

                                    <!-- <button id="edit-name"><img src="{{ url_for('user.static', filename='images/edit.svg') }}"></button> -->
                                </div>
                                <div class="test-photo">
                                    {% if test.image_name %}
                                        <img src="{{ url_for('test.static', filename='images/test_icons/' ~ test.id ~ '.png') }}">
                                    {% else %}
                                        <div class="photo"> </div>
                                    {% endif %}
                                </div>
                                <a href="{{ url_for('test.render_test', test_id=test.id) }}" class="custom-btn btn-1">Дізнатись більше</a>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>

            <div class="completed-tests" id="completed-tests">
                {% if list_completed_tests %}
                    {% for tid in list_completed_tests %}
                        {% set test = Test.query.get(tid) %}
                        {% if test %}
                            <div class="test" data-id="{{ test.id }}" data-title="{{ test.name }}" data-description="{{ test.description or '' }}">
                                <div class="name-block">
                                    <span class="name">{{ test.name }}</span>
                                    <!-- <button id="edit-name"><img src="{{ url_for('user.static', filename='images/edit.svg') }}"></button> -->
                                </div>
                                <div class="test-photo">
                                    {% if test.image_name %}
                                        <img src="{{ url_for('test.static', filename='images/test_icons/' ~ test.id ~ '.png') }}">
                                    {% else %}
                                        <div class="photo"> </div>
                                    {% endif %}
                                </div>
                                <a href="{{ url_for('test.render_test', test_id=test.id) }}" class="custom-btn btn-1">Дізнатись більше</a>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
            <div class="arrows">
                <div class="arrow-block">
                    <object data="{{ url_for('user.static', filename='images/arrow_left.svg') }}" type="image/svg+xml" class="svgToWhite"></object>
                    <object data="{{ url_for('user.static', filename='images/arrow_right.svg') }}" type="image/svg+xml" class="svgToWhite"></object>
                    <!-- <img src="{{ url_for('user.static', filename='images/arrow_right.svg') }}"> -->
                </div>
            </div>
        </div>
        {% if is_author %}
            <div class="settings">
                <p class="settings-input">Налаштування профілю</p>
                <div class="settings-choose">
                    <p class="settings-name">Ім’я користувача:</p>
                    <div class="settings-block">
                        <p class="text">{{ user.nickname }}</p>
                        <img class="img_button" data-field="nickname" src="{{ url_for('user.static', filename='images/edit.svg') }}">
                    </div>
                </div>
                <div class="settings-choose">
                    <p class="settings-name">Електронна адреса  користувача:</p>
                    <div class="settings-block">
                        <p class="text">{{ user.email }}</p>
                        <img class="img_button" data-field="email" src="{{ url_for('user.static', filename='images/edit.svg') }}">
                    </div>
                </div>
                <div class="settings-choose">
                    <p class="settings-name">Пароль користувача:</p>
                    <div class="settings-block password-block">
                        <input id="user-password" class="text" type="password" value="{{ user.password }}" readonly>
                        <button type="button" class="toggle-password">
                            <img src="{{ url_for('user.static', filename='images/hide_close.svg') }}">
                        </button>
                        <img class="img_button" data-field="password" src="{{ url_for('user.static', filename='images/edit.svg') }}">
                    </div>
                </div>
                    <div class="settings-choose">
                    <p class="settings-name">Вказати заклад:</p>
                    <div class="settings-block">
                        <p class="text">{{ user.nickname }}</p>
                        <img class="img_button" src="{{ url_for('user.static', filename='images/edit.svg') }}">
                    </div>
                </div>
                <div class="logout-container">
                    <div class="logout-block">
                        <a href="/logout">Вийти з аккаунта</a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>

{% endblock %}